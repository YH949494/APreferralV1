app = "apreferralv1"
primary_region = "sin"

[env]
  PORT = "8080"

[build]
  dockerfile = "Dockerfile"
 
[experimental]
  auto_rollback = true

# =========================
# Process Groups
# =========================
[processes]
  web = "gunicorn main:app --bind 0.0.0.0:${PORT} --workers 2 --worker-class gthread --threads 4 --timeout 30 --graceful-timeout 30 --keep-alive 5 --max-requests 1000 --max-requests-jitter 100 --access-logfile - --error-logfile -"
  worker = "RUNNER_MODE=worker python main.py"

# =========================
# Web Service (ONLY web)
# =========================
[[services]]
  processes = ["web"]
  internal_port = 8080
  protocol = "tcp"

  [[services.ports]]
    port = 80
    handlers = ["http"]

  [[services.ports]]
    port = 443
    handlers = ["tls", "http"]

#[deploy]
#  release_command = "python /app/app.py"
 
